<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Pulse - Feedback Insights</title>
	</head>
	<body>
		<h1>Pulse Feedback Dashboard</h1>

		<section>
			<h2>Live Sentiment (Workers AI)</h2>
			<div id="sentiment">
				<p>Total Feedback: <strong id="total">-</strong></p>
				<div>
					<p>Positive: <strong id="positive">-</strong></p>
					<p>Neutral: <strong id="neutral">-</strong></p>
					<p>Negative: <strong id="negative">-</strong></p>
				</div>
			</div>
			<button id="refreshBtn" type="button">Refresh Insights</button>
		</section>

		<script>
			function updateSentiment(data) {
				document.getElementById('total').textContent = data.total_feedback;
				document.getElementById('positive').textContent = data.sentiment.positive;
				document.getElementById('neutral').textContent = data.sentiment.neutral;
				document.getElementById('negative').textContent = data.sentiment.negative;
			}

			function loadInsights() {
				fetch('/insights')
					.then((resp) => resp.json())
					.then((data) => {
						updateSentiment(data);
					})
					.catch((error) => {
						console.error('Failed to load insights:', error);
					});
			}

			// Load insights on page load
			loadInsights();

			// Refresh button
			const refreshBtn = document.getElementById('refreshBtn');
			refreshBtn.addEventListener('click', loadInsights);
		</script>
	</body>
</html>
